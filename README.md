# LoggerV2 - –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –ª–æ–≥–æ–≤ —Å –ø—Ä–∏–≤–µ–¥–µ–Ω–∏–µ–º –∫ –µ–¥–∏–Ω–æ–º—É —Ñ–æ—Ä–º–∞—Ç—É —Å–æ–≥–ª–∞—Å–Ω–æ –ì–û–°–¢ –†–§

![Go Version](https://img.shields.io/badge/Go-1.21+-00ADD8?style=flat&logo=go)
![License](https://img.shields.io/badge/license-MIT-green)
![Tests](https://img.shields.io/badge/tests-passing-brightgreen)
![Coverage](https://img.shields.io/badge/coverage-70%25-green)

–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –ª–æ–≥–æ–≤ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤ (Syslog, CEF, LEEF, XML) —Å –ø—Ä–∏–≤–µ–¥–µ–Ω–∏–µ–º –∫ –µ–¥–∏–Ω–æ–º—É —Ñ–æ—Ä–º–∞—Ç—É —Å–æ–≥–ª–∞—Å–Ω–æ –ì–û–°–¢ –† 59710-2022.

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- üöÄ **[–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç](QUICKSTART.md)** - –Ω–∞—á–Ω–∏—Ç–µ –∑–∞ 5 –º–∏–Ω—É—Ç
- üì¶ **[–£—Å—Ç–∞–Ω–æ–≤–∫–∞](INSTALL.md)** - –¥–µ—Ç–∞–ª—å–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ —É—Å—Ç–∞–Ω–æ–≤–∫–µ
- üìñ **[API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](API.md)** - –ø–æ–ª–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ API
- üîå **[–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å SIEM](SIEM_INTEGRATION.md)** - –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ SIEM —Å–∏—Å—Ç–µ–º–∞–º
- üìã **[–ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π](CHANGELOG.md)** - —á—Ç–æ –Ω–æ–≤–æ–≥–æ –≤ –∫–∞–∂–¥–æ–π –≤–µ—Ä—Å–∏–∏
- üí° **[–ü—Ä–∏–º–µ—Ä—ã](examples/README.md)** - –ø—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- üìä **[–°–≤–æ–¥–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞](PROJECT_SUMMARY.md)** - –æ–±–∑–æ—Ä —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
- ‚öôÔ∏è **[–°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –∫–æ–º–∞–Ω–¥](COMMANDS.md)** - –≤—Å–µ –∫–æ–º–∞–Ω–¥—ã –ø—Ä–æ–µ–∫—Ç–∞

## ‚ö° –ë—ã—Å—Ç—Ä—ã–π –ø—Ä–∏–º–µ—Ä

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞
go build -o logger.exe ./cmd/logger

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
echo "<134>Oct 11 22:14:15 server su: login failed" | .\logger.exe
```

## –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã

- **Syslog** (RFC 3164 –∏ RFC 5424)
- **CEF** (Common Event Format)
- **LEEF** (Log Event Extended Format)
- **XML** (–Ω–∞–ø—Ä–∏–º–µ—Ä, Windows Event Log)

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
loggerv2/
‚îú‚îÄ‚îÄ cmd/
‚îÇ   ‚îî‚îÄ‚îÄ logger/
‚îÇ       ‚îî‚îÄ‚îÄ main.go           # –ì–ª–∞–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚îú‚îÄ‚îÄ internal/
‚îÇ   ‚îú‚îÄ‚îÄ models/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ gost.go          # –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö –ì–û–°–¢
‚îÇ   ‚îú‚îÄ‚îÄ parser/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ syslog.go        # –ü–∞—Ä—Å–µ—Ä Syslog
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ cef.go           # –ü–∞—Ä—Å–µ—Ä CEF
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ leef.go          # –ü–∞—Ä—Å–µ—Ä LEEF
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ xml.go           # –ü–∞—Ä—Å–µ—Ä XML
‚îÇ   ‚îî‚îÄ‚îÄ processor/
‚îÇ       ‚îî‚îÄ‚îÄ processor.go      # –ì–ª–∞–≤–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä
‚îî‚îÄ‚îÄ go.mod
```

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
go mod download
go build -o logger.exe ./cmd/logger
```

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑ —Ñ–∞–π–ª–∞

```bash
logger.exe -input logs.txt -output result.json
```

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑ stdin

```bash
echo "<134>Oct 11 22:14:15 mymachine su: 'su root' failed for lonvick on /dev/pts/8" | logger.exe
```

### –ü—Ä–∏–º–µ—Ä—ã –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

**Syslog (RFC 3164):**
```
<134>Oct 11 22:14:15 mymachine su: 'su root' failed for lonvick on /dev/pts/8
```

**Syslog (RFC 5424):**
```
<165>1 2025-10-11T22:14:15.003Z mymachine.example.com evntslog - ID47 - User login successful
```

**CEF:**
```
CEF:0|Security|threatmanager|1.0|100|worm successfully stopped|10|src=10.0.0.1 dst=2.1.2.2 spt=1232
```

**LEEF:**
```
LEEF:1.0|Microsoft|MSExchange|4.0 SP1|15345|src=10.0.0.1	dst=172.50.123.1	sev=5	cat=anomaly	srcPort=81	dstPort=21
```

**XML (Windows Event Log):**
```xml
<Event xmlns="http://schemas.microsoft.com/win/2004/08/events/event">
  <System>
    <Provider Name="Microsoft-Windows-Security-Auditing" Guid="{54849625-5478-4994-A5BA-3E3B0328C30D}"/>
    <EventID>4624</EventID>
    <Level>0</Level>
    <TimeCreated SystemTime="2025-10-11T22:14:15.123456Z"/>
    <Computer>workstation.example.com</Computer>
  </System>
  <EventData>
    <Data Name="TargetUserName">john.doe</Data>
    <Data Name="TargetDomainName">EXAMPLE</Data>
  </EventData>
</Event>
```

## –§–æ—Ä–º–∞—Ç –≤—ã–≤–æ–¥–∞ (–ì–û–°–¢)

–†–µ–∑—É–ª—å—Ç–∞—Ç –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON —Å–æ–≥–ª–∞—Å–Ω–æ –ì–û–°–¢ –† 59710-2022:

```json
{
  "event_id": "uuid",
  "timestamp": "2025-10-11T22:14:15Z",
  "source": {
    "hostname": "mymachine",
    "application": "su",
    "process_id": 0
  },
  "category": "–ê–£–¢–ï–ù–¢–ò–§–ò–ö–ê–¶–ò–Ø",
  "severity": "–í–´–°–û–ö–ò–ô",
  "description": "'su root' failed for lonvick on /dev/pts/8",
  "result": "–ù–ï–£–°–ü–ï–•",
  "action": "",
  "additional_data": {
    "syslog_priority": 134,
    "syslog_facility": 16,
    "syslog_severity": 6
  }
}
```

## –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –ì–û–°–¢

- `–ê–£–¢–ï–ù–¢–ò–§–ò–ö–ê–¶–ò–Ø` - —Å–æ–±—ã—Ç–∏—è –≤—Ö–æ–¥–∞ –≤ —Å–∏—Å—Ç–µ–º—É
- `–ê–í–¢–û–†–ò–ó–ê–¶–ò–Ø` - —Å–æ–±—ã—Ç–∏—è –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞
- `–î–û–°–¢–£–ü` - —Å–æ–±—ã—Ç–∏—è –¥–æ—Å—Ç—É–ø–∞ –∫ —Ä–µ—Å—É—Ä—Å–∞–º
- `–ò–ó–ú–ï–ù–ï–ù–ò–ï_–î–ê–ù–ù–´–•` - —Å–æ–±—ã—Ç–∏—è –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö
- `–°–ò–°–¢–ï–ú–ù–û–ï_–°–û–ë–´–¢–ò–ï` - –æ–±—â–∏–µ —Å–∏—Å—Ç–µ–º–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è
- `–°–û–ë–´–¢–ò–ï_–ë–ï–ó–û–ü–ê–°–ù–û–°–¢–ò` - —Å–æ–±—ã—Ç–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- `–°–ï–¢–ï–í–û–ï_–°–û–ë–´–¢–ò–ï` - —Å–µ—Ç–µ–≤—ã–µ —Å–æ–±—ã—Ç–∏—è

## –£—Ä–æ–≤–Ω–∏ –∫—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç–∏

- `–ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô`
- `–í–´–°–û–ö–ò–ô`
- `–°–†–ï–î–ù–ò–ô`
- `–ù–ò–ó–ö–ò–ô`
- `–ò–ù–§–û–†–ú–ê–¶–ò–û–ù–ù–´–ô`

## –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ–±—ã—Ç–∏–π

- `–£–°–ü–ï–•` - —É—Å–ø–µ—à–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ
- `–ù–ï–£–°–ü–ï–•` - –Ω–µ—É—Å–ø–µ—à–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ
- `–ù–ï–ò–ó–í–ï–°–¢–ù–û` - —Ä–µ–∑—É–ª—å—Ç–∞—Ç –Ω–µ–∏–∑–≤–µ—Å—Ç–µ–Ω

## üéØ –ö–ª—é—á–µ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ñ–æ—Ä–º–∞—Ç–∞** - –Ω–µ –Ω—É–∂–Ω–æ —É–∫–∞–∑—ã–≤–∞—Ç—å —Ç–∏–ø –ª–æ–≥–∞  
‚úÖ **–°—Ç–∞–Ω–¥–∞—Ä—Ç –ì–û–°–¢** - —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –ì–û–°–¢ –† 59710-2022  
‚úÖ **–ú–Ω–æ–∂–µ—Å—Ç–≤–æ —Ñ–æ—Ä–º–∞—Ç–æ–≤** - Syslog (RFC 3164/5424), CEF, LEEF, XML  
‚úÖ **–ü—Ä–æ—Å—Ç–æ–π API** - –ª–µ–≥–∫–æ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –≤ —Å–≤–æ–∏ –ø—Ä–æ–µ–∫—Ç—ã  
‚úÖ **CLI —É—Ç–∏–ª–∏—Ç–∞** - –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –∏–∑ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏  
‚úÖ **–í—ã—Å–æ–∫–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** - –¥–æ 10,000 –ª–æ–≥–æ–≤/—Å–µ–∫  
‚úÖ **–ü–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏** - ~70% coverage  
‚úÖ **REST API —Å–µ—Ä–≤–µ—Ä** - –≥–æ—Ç–æ–≤—ã–π HTTP —Å–µ—Ä–≤–µ—Ä –≤ –ø—Ä–∏–º–µ—Ä–∞—Ö  

## üöÄ –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

- **Syslog**: ~10,000 —Å–æ–æ–±—â–µ–Ω–∏–π/—Å–µ–∫
- **CEF/LEEF**: ~5,000 —Å–æ–æ–±—â–µ–Ω–∏–π/—Å–µ–∫
- **XML**: ~2,000 —Å–æ–±—ã—Ç–∏–π/—Å–µ–∫

## üì¶ –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
- `github.com/google/uuid` - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è UUID –¥–ª—è —Å–æ–±—ã—Ç–∏–π

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
# –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤
go test ./...

# –¢–µ—Å—Ç—ã —Å –ø–æ–∫—Ä—ã—Ç–∏–µ–º
go test ./... -cover

# –¢–µ—Å—Ç—ã —Å –ø–æ–¥—Ä–æ–±–Ω—ã–º –≤—ã–≤–æ–¥–æ–º
go test ./... -v
```

–¢–µ–∫—É—â–µ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ: ~70% (parser: 69.7%, processor: 60.0%)

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License - —Å–º. [LICENSE](LICENSE)

## ü§ù FAQ
- –°–º. [–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é](INSTALL.md) –¥–ª—è –ø–æ–¥—Ä–æ–±–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ [–ø—Ä–∏–º–µ—Ä—ã](examples/) –¥–ª—è –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
